graph TB
    subgraph "Client Layer"
        Browser[Web Browser]
        DarkMode[Dark Mode Toggle]
    end

    subgraph "Next.js Application"
        Pages[Pages - App Router]
        Components[React Components]
        ServerActions[Server Actions]
        Middleware[Auth Middleware]

        Pages --> Components
        Pages --> ServerActions
        Components --> ServerActions
    end

    subgraph "Authentication"
        SupabaseAuth[Supabase Auth]
        RLS[Row Level Security]
        Permissions[Role-Based Access]
    end

    subgraph "Database"
        PostgreSQL[(PostgreSQL - Supabase)]
        Tables[Tables: users, contacts, deals, activities]
    end

    Browser --> Pages
    DarkMode --> Browser
    Middleware --> SupabaseAuth
    ServerActions --> SupabaseAuth
    SupabaseAuth --> RLS
    RLS --> PostgreSQL
    Permissions --> RLS
    PostgreSQL --> Tables

    style Browser fill:#3b82f6
    style PostgreSQL fill:#10b981
    style SupabaseAuth fill:#8b5cf6