{
  "document": {
    "title": "Product Requirements Document (PRD)",
    "subtitle": "CRM Application - V1.0 MVP",
    "version": "1.0",
    "date": "2025-10-20",
    "status": "Draft - Ready for Architecture Review",
    "author": "Product Team"
  },
  "documentControl": {
    "versions": [
      {
        "version": "1.0",
        "date": "2025-10-20",
        "author": "Product Team",
        "changes": "Initial minimal MVP PRD"
      }
    ]
  },
  "executiveSummary": {
    "productVision": "A **simple, fast CRM** that helps small sales teams manage contacts and close deals without the complexity and cost of enterprise solutions like Salesforce.",
    "mvpScope": {
      "coreFeatures": [
        "Contact Management (CRUD, search, import)",
        "Deal Pipeline (Kanban board, stages, tracking)",
        "Activity Logging (calls, emails, meetings, notes)",
        "Time Tracking (timer, billable hours, admin reports)",
        "Basic Reporting (3 essential reports)",
        "User Management (basic roles)"
      ],
      "timeline": "2-3 months to launch",
      "target": "100 beta users by Month 3"
    },
    "keyDifferentiators": [
      "Lightning Fast Setup: 5 minutes vs 2 weeks (Salesforce)",
      "Dead Simple: No training required",
      "Affordable: Free tier + $29/user/month vs Salesforce $150+",
      "Modern Tech: Built with Next.js 15, not legacy architecture"
    ],
    "nonGoals": {
      "outOfScope": [
        "Email integration (Gmail, Outlook) → V2.0",
        "Calendar integration → V2.0",
        "Lead scoring → V2.0",
        "Automation/workflows → V2.0",
        "Slack/Stripe/Zapier integrations → V2.0+",
        "Native mobile apps → V2.0",
        "Advanced permissions → V2.0"
      ],
      "inScope": [
        "Core CRM: Contacts, Deals, Activities",
        "Time tracking with billable hours",
        "Mobile-responsive web UI",
        "CSV import/export",
        "4 basic reports (including time tracking)",
        "Simple user roles (Admin, User)"
      ]
    }
  },
  "productStrategy": {
    "marketOpportunity": {
      "targetMarket": "Small B2B sales teams (5-50 people)",
      "problem": "Existing CRMs are too complex/expensive for small teams",
      "solution": "Minimal CRM focused on core workflows"
    },
    "positioning": "The CRM you can set up in 5 minutes and actually want to use",
    "goToMarket": {
      "betaLaunch": "Month 3",
      "freeTier": "Up to 3 users, 100 contacts",
      "paidTier": "$29/user/month, unlimited contacts"
    }
  },
  "targetUsers": {
    "primaryPersona": {
      "name": "Sarah",
      "role": "Sales Rep (Account Executive at 20-person company)",
      "currentTool": "Spreadsheets or HubSpot Free",
      "painPoints": [
        "Too much time on data entry",
        "Can't find customer info quickly",
        "No visibility into pipeline"
      ],
      "goals": [
        "Log activities in <15 seconds",
        "See all customer history in one place",
        "Track deals visually"
      ]
    },
    "secondaryPersona": {
      "name": "Michael",
      "role": "Sales Manager (Head of Sales at 30-person company)",
      "currentTool": "Spreadsheets + Slack",
      "painPoints": [
        "No real-time pipeline visibility",
        "Manual reporting takes hours",
        "Can't forecast accurately"
      ],
      "goals": [
        "See team pipeline at a glance",
        "Generate reports in 1 click",
        "Track team activity"
      ]
    }
  },
  "coreFeatures": {
    "mustHave": [
      {
        "id": 1,
        "name": "Contact Management",
        "priority": "P0",
        "details": {
          "operations": "Create, read, update, delete contacts",
          "fields": "Name, email, phone, company, title, status (lead/customer)",
          "search": "Global search by name, email, company",
          "import": "CSV upload (up to 1,000 contacts)",
          "export": "CSV download",
          "customFields": "5 custom fields per contact"
        }
      },
      {
        "id": 2,
        "name": "Deal Pipeline",
        "priority": "P0",
        "details": {
          "visualKanban": "Drag-and-drop pipeline board",
          "dealStages": [
            "Lead",
            "Qualified",
            "Proposal",
            "Negotiation",
            "Closed Won/Lost"
          ],
          "customization": "Customizable stage names and order",
          "dealFields": "Name, value, close date, stage, probability",
          "dealDetail": "View/edit all deal information",
          "linkToContacts": "Associate deals with contacts/companies"
        }
      },
      {
        "id": 3,
        "name": "Activity Logging",
        "priority": "P0",
        "details": {
          "quickLog": "Log call, email, meeting, or note in <15 seconds",
          "activityTypes": ["Call", "Email", "Meeting", "Note"],
          "fields": "Type, date, duration, notes, related contact/deal",
          "timeline": "View all activities for a contact or deal",
          "keyboardShortcuts": {
            "C": "Log call",
            "E": "Log email",
            "M": "Log meeting",
            "N": "Add note"
          }
        }
      },
      {
        "id": 4,
        "name": "Time Tracking",
        "priority": "P0",
        "details": {
          "automaticTimer": "Start/stop timer for leads and deals",
          "activityBasedTracking": "Auto-log time when activities are created",
          "manualTimeEntry": "Add/edit time entries manually",
          "billableHours": "Mark time as billable or non-billable",
          "timeApproval": "Admin can approve/reject time entries",
          "adminDashboard": {
            "viewTotalTime": "Per user, per lead, per deal",
            "filters": "Date range, user, billable status",
            "export": "Export timesheets to CSV"
          }
        }
      },
      {
        "id": 5,
        "name": "Basic Reporting",
        "priority": "P0",
        "reports": [
          {
            "name": "Sales Pipeline",
            "metrics": [
              "Deals by stage",
              "Total value per stage",
              "Filter by user, date range"
            ]
          },
          {
            "name": "Activity Summary",
            "metrics": [
              "Activities logged per user",
              "Breakdown by type (calls, emails, meetings)"
            ]
          },
          {
            "name": "Win/Loss Report",
            "metrics": [
              "Win rate by stage",
              "Lost deal reasons",
              "Average deal size"
            ]
          },
          {
            "name": "Time Tracking Report",
            "metrics": [
              "Total hours per user, per lead, per deal",
              "Billable vs non-billable breakdown",
              "Export to CSV for payroll/invoicing"
            ]
          }
        ]
      },
      {
        "id": 6,
        "name": "User Management",
        "priority": "P0",
        "details": {
          "roles": [
            {
              "name": "Admin",
              "permissions": "Full access, manage users, settings"
            },
            {
              "name": "User",
              "permissions": "Access own data, view team data"
            }
          ],
          "userProfile": "Name, email, password, timezone",
          "teamView": "See all users and their activity"
        }
      }
    ]
  },
  "functionalRequirements": {
    "contactManagement": [
      {
        "id": "FR-CM-001",
        "name": "Create Contact",
        "priority": "P0",
        "userStory": "As a sales rep, I want to create a new contact in under 30 seconds so that I can quickly capture lead information.",
        "acceptanceCriteria": [
          "AC1: Form opens in <500ms",
          "AC2: Required fields: First Name, Last Name, Email",
          "AC3: Email format validation (on blur)",
          "AC4: Duplicate detection: Warn if email exists",
          "AC5: Save completes in <2 seconds",
          "AC6: Redirect to contact detail page after save"
        ]
      },
      {
        "id": "FR-CM-002",
        "name": "Contact List View",
        "priority": "P0",
        "acceptanceCriteria": [
          "AC1: Load 100 contacts in <1 second",
          "AC2: Columns: Name, Company, Email, Status, Owner",
          "AC3: Sort by any column",
          "AC4: Filter by owner, status",
          "AC5: Pagination (100 per page)",
          "AC6: Global search (name, email, company)"
        ]
      },
      {
        "id": "FR-CM-003",
        "name": "Import Contacts (CSV)",
        "priority": "P0",
        "acceptanceCriteria": [
          "AC1: Support CSV format",
          "AC2: Map CSV columns to CRM fields",
          "AC3: Import up to 1,000 contacts",
          "AC4: Complete in <30 seconds for 1,000 contacts",
          "AC5: Duplicate detection by email",
          "AC6: Show import summary (created, skipped, errors)"
        ]
      }
    ],
    "dealManagement": [
      {
        "id": "FR-DM-001",
        "name": "Visual Pipeline Board",
        "priority": "P0",
        "userStory": "As a sales rep, I want to see all my deals in a visual pipeline so I can prioritize my work.",
        "acceptanceCriteria": [
          "AC1: Kanban board with 5 stages (Lead, Qualified, Proposal, Negotiation, Closed)",
          "AC2: Drag-and-drop to move deals between stages",
          "AC3: Show deal name, value, close date on card",
          "AC4: Load 100 deals in <1 second",
          "AC5: Filter by owner, date range",
          "AC6: Total value displayed per stage"
        ]
      },
      {
        "id": "FR-DM-002",
        "name": "Create Deal",
        "priority": "P0",
        "acceptanceCriteria": [
          "AC1: Required fields: Deal Name, Value, Close Date, Stage",
          "AC2: Default stage: 'Qualified'",
          "AC3: Default close date: 30 days from today",
          "AC4: Link to contact/company (optional)",
          "AC5: Save in <2 seconds",
          "AC6: Redirect to deal detail page"
        ]
      },
      {
        "id": "FR-DM-003",
        "name": "Deal Detail Page",
        "priority": "P0",
        "acceptanceCriteria": [
          "AC1: Show all deal fields (editable inline)",
          "AC2: Activity timeline (calls, emails, meetings, notes)",
          "AC3: Quick log activity from deal page",
          "AC4: Stage history (audit trail)",
          "AC5: Load in <1 second"
        ]
      }
    ],
    "activityLogging": [
      {
        "id": "FR-AL-001",
        "name": "Quick Log Activity",
        "priority": "P0",
        "userStory": "As a sales rep, I want to log a call in under 15 seconds so I don't lose momentum.",
        "acceptanceCriteria": [
          "AC1: Modal opens in <300ms",
          "AC2: Required fields: Type, Date, Related Contact/Deal",
          "AC3: Optional fields: Duration, Notes",
          "AC4: Keyboard shortcuts work (C, E, M, N)",
          "AC5: Save in <1 second",
          "AC6: Activity appears in timeline immediately"
        ]
      },
      {
        "id": "FR-AL-002",
        "name": "Activity Timeline",
        "priority": "P0",
        "acceptanceCriteria": [
          "AC1: Show all activities for a contact or deal",
          "AC2: Sort by date (newest first)",
          "AC3: Load 50 activities in <500ms",
          "AC4: Filter by type (call, email, meeting, note)",
          "AC5: Edit/delete any activity"
        ]
      }
    ],
    "timeTracking": [
      {
        "id": "FR-TT-001",
        "name": "Start/Stop Timer",
        "priority": "P1",
        "userStory": "As a sales rep, I want to start a timer when I begin working on a lead so that my time is automatically tracked without manual entry.",
        "acceptanceCriteria": [
          "AC1: Timer button visible on contact and deal pages",
          "AC2: Click 'Start Timer' → Timer begins (shows elapsed time)",
          "AC3: Click 'Stop Timer' → Time entry created automatically",
          "AC4: Timer persists across page navigation",
          "AC5: Only one timer can run at a time",
          "AC6: Timer shows notification if left running >8 hours"
        ]
      },
      {
        "id": "FR-TT-002",
        "name": "Manual Time Entry",
        "priority": "P1",
        "userStory": "As a sales rep, I want to manually add time I spent on a lead yesterday so I can track all my work accurately.",
        "acceptanceCriteria": [
          "AC1: 'Add Time' button on contact/deal pages",
          "AC2: Required fields: Duration (hours/minutes), Date, Related Contact/Deal",
          "AC3: Optional fields: Notes, Billable (checkbox, default: true)",
          "AC4: Duration can be entered as HH:MM or decimal (1.5 hours)",
          "AC5: Save in <1 second",
          "AC6: Time entry appears in timeline immediately"
        ]
      },
      {
        "id": "FR-TT-003",
        "name": "Activity-Based Auto-Tracking",
        "priority": "P1",
        "userStory": "As a sales rep, when I log a call that lasted 30 minutes, I want the time to be automatically tracked so I don't have to enter it twice.",
        "acceptanceCriteria": [
          "AC1: When activity with duration is logged, create time entry automatically",
          "AC2: Time entry links to the activity",
          "AC3: User can edit/delete auto-created time entries",
          "AC4: Checkbox in activity form: 'Track time for this activity' (default: checked)",
          "AC5: Duration from activity maps to time entry duration"
        ]
      },
      {
        "id": "FR-TT-004",
        "name": "Billable Hours Tracking",
        "priority": "P1",
        "userStory": "As an admin, I want to mark time as billable or non-billable so I can invoice clients accurately.",
        "acceptanceCriteria": [
          "AC1: Each time entry has 'Billable' checkbox",
          "AC2: Default billable status configurable per user (Admin setting)",
          "AC3: Admin can bulk update billable status for multiple entries",
          "AC4: Time tracking report shows billable vs non-billable breakdown",
          "AC5: Export includes billable flag"
        ]
      },
      {
        "id": "FR-TT-005",
        "name": "Time Approval Workflow",
        "priority": "P1",
        "userStory": "As an admin, I want to approve time entries before they're finalized so I can ensure accuracy.",
        "acceptanceCriteria": [
          "AC1: Time entries have status: Draft, Submitted, Approved, Rejected",
          "AC2: Users can submit time for approval (changes status to 'Submitted')",
          "AC3: Admin sees pending approvals in dashboard",
          "AC4: Admin can approve/reject with optional note",
          "AC5: Approved time cannot be edited by user (only admin)",
          "AC6: Rejected time returns to Draft with admin note visible"
        ]
      },
      {
        "id": "FR-TT-006",
        "name": "Admin Time Tracking Dashboard",
        "priority": "P1",
        "userStory": "As an admin, I want to see total time tracked per user and per lead so I can manage team workload and billing.",
        "acceptanceCriteria": [
          "AC1: Dashboard shows total hours (today, this week, this month)",
          "AC2: Breakdown by user (sortable table)",
          "AC3: Breakdown by contact/deal (top 10 by hours)",
          "AC4: Filter by date range, user, billable status, approval status",
          "AC5: Visual chart: Hours per day (last 7 days)",
          "AC6: 'Export Timesheet' button → CSV download",
          "AC7: Load in <2 seconds"
        ]
      }
    ],
    "reporting": [
      {
        "id": "FR-RP-001",
        "name": "Sales Pipeline Report",
        "priority": "P1",
        "acceptanceCriteria": [
          "AC1: Show deals by stage",
          "AC2: Total value per stage",
          "AC3: Filter by owner, date range",
          "AC4: Export to CSV",
          "AC5: Load in <2 seconds"
        ]
      },
      {
        "id": "FR-RP-002",
        "name": "Activity Summary Report",
        "priority": "P1",
        "acceptanceCriteria": [
          "AC1: Activities logged per user (last 30 days)",
          "AC2: Breakdown by type (calls, emails, meetings)",
          "AC3: Filter by user, date range",
          "AC4: Export to CSV"
        ]
      },
      {
        "id": "FR-RP-003",
        "name": "Time Tracking Report",
        "priority": "P1",
        "userStory": "As an admin, I want to export timesheets for payroll and invoicing so I can bill clients accurately.",
        "acceptanceCriteria": [
          "AC1: Show total hours per user (sortable table)",
          "AC2: Show total hours per contact/deal",
          "AC3: Breakdown: Billable vs Non-billable hours",
          "AC4: Breakdown: Approved vs Pending vs Rejected",
          "AC5: Filter by date range, user, billable status, approval status",
          "AC6: Export to CSV with columns: Date, User, Contact/Deal, Duration, Billable, Status, Notes",
          "AC7: Load in <2 seconds for <10,000 time entries"
        ]
      }
    ]
  },
  "nonFunctionalRequirements": {
    "performance": {
      "pageLoad": "P95 < 2 seconds on 4G",
      "apiLatency": "P95 < 500ms",
      "databaseQueries": "No query > 100ms"
    },
    "security": {
      "authentication": "Email/password + 2FA (optional)",
      "authorization": "Role-based access control",
      "dataEncryption": "At rest (database) and in transit (HTTPS)",
      "passwordPolicy": "Min 8 characters, require letters + numbers"
    },
    "scalability": {
      "users": "Support up to 500 concurrent users",
      "data": "Handle 100,000 contacts, 50,000 deals",
      "growth": "Architecture supports 10x growth without major refactor"
    },
    "reliability": {
      "uptime": "99.5% availability target",
      "dataBackup": "Daily automated backups",
      "recovery": "RTO < 4 hours, RPO < 1 hour"
    }
  },
  "techStack": {
    "architecture": "Serverless Monolith (Next.js App Router)",
    "frontend": {
      "framework": "Next.js 15 (App Router)",
      "uiLibrary": "React 19",
      "language": "TypeScript",
      "styling": "Tailwind CSS",
      "stateManagement": "React Context + Server State"
    },
    "backend": {
      "api": "Next.js API Routes + Server Actions",
      "language": "TypeScript"
    },
    "database": {
      "primary": "Supabase (PostgreSQL 14)",
      "features": ["Row Level Security", "Real-time subscriptions"]
    },
    "authentication": {
      "provider": "Supabase Auth",
      "methods": ["Email/password", "OAuth (Google, GitHub)"]
    },
    "storage": {
      "files": "Supabase Storage (for CSV imports)"
    },
    "deployment": {
      "platform": "Vercel",
      "cicd": "GitHub Actions",
      "domain": "Custom domain via Vercel"
    },
    "monitoring": {
      "analytics": "Vercel Analytics",
      "errors": "Vercel Logs + Supabase Dashboard"
    }
  },
  "epics": [
    {
      "id": 1,
      "name": "Foundation & Authentication",
      "goal": "Basic app infrastructure and user authentication",
      "stories": [
        "Story 1.1: Project setup (Next.js 15 + Supabase + Vercel)",
        "Story 1.2: Authentication UI (Signup, Login, Logout)",
        "Story 1.3: User profile page",
        "Story 1.4: Role-based access control (Admin, User)"
      ],
      "estimatedTime": "1 week"
    },
    {
      "id": 2,
      "name": "Contact Management",
      "goal": "Full contact lifecycle management",
      "stories": [
        "Story 2.1: Create contact form with validation",
        "Story 2.2: Contact list view (table, search, filters)",
        "Story 2.3: Contact detail page",
        "Story 2.4: Edit/delete contact",
        "Story 2.5: CSV import wizard",
        "Story 2.6: CSV export",
        "Story 2.7: Custom fields (5 per contact)"
      ],
      "estimatedTime": "2 weeks"
    },
    {
      "id": 3,
      "name": "Deal Pipeline",
      "goal": "Visual deal management and tracking",
      "stories": [
        "Story 3.1: Pipeline Kanban board (drag-and-drop)",
        "Story 3.2: Create deal form",
        "Story 3.3: Deal detail page",
        "Story 3.4: Edit/delete deal",
        "Story 3.5: Deal stage configuration (admin)",
        "Story 3.6: Link deals to contacts/companies"
      ],
      "estimatedTime": "2 weeks"
    },
    {
      "id": 4,
      "name": "Activity Logging",
      "goal": "Quick activity tracking and timeline",
      "stories": [
        "Story 4.1: Quick log modal (calls, emails, meetings, notes)",
        "Story 4.2: Activity timeline component",
        "Story 4.3: Keyboard shortcuts (C, E, M, N)",
        "Story 4.4: Edit/delete activities",
        "Story 4.5: Activity filters (type, date)"
      ],
      "estimatedTime": "1 week"
    },
    {
      "id": 5,
      "name": "Time Tracking",
      "goal": "Comprehensive time tracking and billing management",
      "stories": [
        "Story 5.1: Start/stop timer component (persists across navigation)",
        "Story 5.2: Manual time entry form",
        "Story 5.3: Activity-based auto-tracking (link time to activities)",
        "Story 5.4: Billable hours configuration (default per user)",
        "Story 5.5: Time approval workflow (submit, approve, reject)",
        "Story 5.6: Admin time tracking dashboard",
        "Story 5.7: Time tracking report with CSV export"
      ],
      "estimatedTime": "1.5 weeks"
    },
    {
      "id": 6,
      "name": "Reporting",
      "goal": "Basic sales insights",
      "stories": [
        "Story 6.1: Sales pipeline report",
        "Story 6.2: Activity summary report",
        "Story 6.3: Win/loss report",
        "Story 6.4: Time tracking report (see Epic 5)",
        "Story 6.5: CSV export for all reports"
      ],
      "estimatedTime": "1 week"
    },
    {
      "id": 7,
      "name": "User Management",
      "goal": "Team collaboration features",
      "stories": [
        "Story 7.1: User list (admin only)",
        "Story 7.2: Invite users",
        "Story 7.3: Assign roles",
        "Story 7.4: User activity log"
      ],
      "estimatedTime": "3 days"
    },
    {
      "id": 8,
      "name": "Polish & Launch Prep",
      "goal": "Production-ready quality",
      "stories": [
        "Story 8.1: Mobile responsive optimization",
        "Story 8.2: Loading states and error handling",
        "Story 8.3: Onboarding tutorial",
        "Story 8.4: Performance optimization",
        "Story 8.5: Security audit",
        "Story 8.6: Beta testing with 10 users"
      ],
      "estimatedTime": "1 week"
    }
  ],
  "dataModel": {
    "tables": {
      "users": {
        "columns": [
          { "name": "id", "type": "UUID", "constraints": "PRIMARY KEY DEFAULT uuid_generate_v4()" },
          { "name": "email", "type": "TEXT", "constraints": "UNIQUE NOT NULL" },
          { "name": "full_name", "type": "TEXT", "constraints": "NOT NULL" },
          { "name": "role", "type": "TEXT", "constraints": "NOT NULL CHECK (role IN ('admin', 'user'))" },
          { "name": "created_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" },
          { "name": "updated_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" }
        ]
      },
      "contacts": {
        "columns": [
          { "name": "id", "type": "UUID", "constraints": "PRIMARY KEY DEFAULT uuid_generate_v4()" },
          { "name": "first_name", "type": "TEXT", "constraints": "NOT NULL" },
          { "name": "last_name", "type": "TEXT", "constraints": "NOT NULL" },
          { "name": "email", "type": "TEXT", "constraints": "" },
          { "name": "phone", "type": "TEXT", "constraints": "" },
          { "name": "company", "type": "TEXT", "constraints": "" },
          { "name": "title", "type": "TEXT", "constraints": "" },
          { "name": "status", "type": "TEXT", "constraints": "CHECK (status IN ('lead', 'customer'))" },
          { "name": "owner_id", "type": "UUID", "constraints": "REFERENCES users(id)" },
          { "name": "custom_fields", "type": "JSONB", "constraints": "" },
          { "name": "created_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" },
          { "name": "updated_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" },
          { "name": "deleted_at", "type": "TIMESTAMPTZ", "constraints": "" }
        ],
        "indexes": [
          "idx_contacts_email ON contacts(email) WHERE deleted_at IS NULL",
          "idx_contacts_owner ON contacts(owner_id) WHERE deleted_at IS NULL",
          "idx_contacts_search ON contacts USING GIN(to_tsvector('english', first_name || ' ' || last_name || ' ' || COALESCE(email, '') || ' ' || COALESCE(company, '')))"
        ]
      },
      "deals": {
        "columns": [
          { "name": "id", "type": "UUID", "constraints": "PRIMARY KEY DEFAULT uuid_generate_v4()" },
          { "name": "name", "type": "TEXT", "constraints": "NOT NULL" },
          { "name": "amount", "type": "DECIMAL(12, 2)", "constraints": "" },
          { "name": "stage", "type": "TEXT", "constraints": "NOT NULL" },
          { "name": "probability", "type": "INTEGER", "constraints": "DEFAULT 25" },
          { "name": "expected_close_date", "type": "DATE", "constraints": "" },
          { "name": "contact_id", "type": "UUID", "constraints": "REFERENCES contacts(id)" },
          { "name": "owner_id", "type": "UUID", "constraints": "REFERENCES users(id)" },
          { "name": "status", "type": "TEXT", "constraints": "CHECK (status IN ('open', 'won', 'lost'))" },
          { "name": "created_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" },
          { "name": "updated_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" },
          { "name": "deleted_at", "type": "TIMESTAMPTZ", "constraints": "" }
        ],
        "indexes": [
          "idx_deals_stage ON deals(stage) WHERE deleted_at IS NULL AND status = 'open'",
          "idx_deals_owner ON deals(owner_id) WHERE deleted_at IS NULL"
        ]
      },
      "activities": {
        "columns": [
          { "name": "id", "type": "UUID", "constraints": "PRIMARY KEY DEFAULT uuid_generate_v4()" },
          { "name": "type", "type": "TEXT", "constraints": "NOT NULL CHECK (type IN ('call', 'email', 'meeting', 'note'))" },
          { "name": "subject", "type": "TEXT", "constraints": "" },
          { "name": "notes", "type": "TEXT", "constraints": "" },
          { "name": "duration_minutes", "type": "INTEGER", "constraints": "" },
          { "name": "contact_id", "type": "UUID", "constraints": "REFERENCES contacts(id) ON DELETE CASCADE" },
          { "name": "deal_id", "type": "UUID", "constraints": "REFERENCES deals(id) ON DELETE CASCADE" },
          { "name": "owner_id", "type": "UUID", "constraints": "REFERENCES users(id)" },
          { "name": "activity_date", "type": "TIMESTAMPTZ", "constraints": "NOT NULL DEFAULT NOW()" },
          { "name": "created_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" }
        ],
        "indexes": [
          "idx_activities_contact ON activities(contact_id, activity_date DESC)",
          "idx_activities_deal ON activities(deal_id, activity_date DESC)"
        ]
      },
      "time_entries": {
        "columns": [
          { "name": "id", "type": "UUID", "constraints": "PRIMARY KEY DEFAULT uuid_generate_v4()" },
          { "name": "user_id", "type": "UUID", "constraints": "NOT NULL REFERENCES users(id) ON DELETE CASCADE" },
          { "name": "contact_id", "type": "UUID", "constraints": "REFERENCES contacts(id) ON DELETE CASCADE" },
          { "name": "deal_id", "type": "UUID", "constraints": "REFERENCES deals(id) ON DELETE CASCADE" },
          { "name": "activity_id", "type": "UUID", "constraints": "REFERENCES activities(id) ON DELETE SET NULL" },
          { "name": "duration_minutes", "type": "INTEGER", "constraints": "NOT NULL CHECK (duration_minutes > 0)" },
          { "name": "entry_date", "type": "DATE", "constraints": "NOT NULL DEFAULT CURRENT_DATE" },
          { "name": "notes", "type": "TEXT", "constraints": "" },
          { "name": "is_billable", "type": "BOOLEAN", "constraints": "DEFAULT true" },
          { "name": "status", "type": "TEXT", "constraints": "NOT NULL DEFAULT 'draft' CHECK (status IN ('draft', 'submitted', 'approved', 'rejected'))" },
          { "name": "approval_notes", "type": "TEXT", "constraints": "" },
          { "name": "approved_by", "type": "UUID", "constraints": "REFERENCES users(id)" },
          { "name": "approved_at", "type": "TIMESTAMPTZ", "constraints": "" },
          { "name": "created_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" },
          { "name": "updated_at", "type": "TIMESTAMPTZ", "constraints": "DEFAULT NOW()" }
        ],
        "indexes": [
          "idx_time_entries_user ON time_entries(user_id, entry_date DESC)",
          "idx_time_entries_contact ON time_entries(contact_id) WHERE contact_id IS NOT NULL",
          "idx_time_entries_deal ON time_entries(deal_id) WHERE deal_id IS NOT NULL",
          "idx_time_entries_status ON time_entries(status, user_id)",
          "idx_time_entries_billable ON time_entries(is_billable, entry_date)"
        ]
      }
    },
    "relationships": [
      "users (1) ----< (many) contacts [owner]",
      "users (1) ----< (many) deals [owner]",
      "users (1) ----< (many) activities [owner]",
      "users (1) ----< (many) time_entries [tracked by]",
      "users (1) ----< (many) time_entries [approved by]",
      "contacts (1) ----< (many) deals [primary contact]",
      "contacts (1) ----< (many) activities [related to]",
      "contacts (1) ----< (many) time_entries [related to]",
      "deals (1) ----< (many) activities [related to]",
      "deals (1) ----< (many) time_entries [related to]",
      "activities (1) ----< (1) time_entries [auto-tracked from]"
    ]
  },
  "uiUxGuidelines": {
    "designPrinciples": [
      "Speed First: Every action completes in <2 seconds",
      "Mobile-Friendly: Responsive design, works on iPhone/Android",
      "Keyboard-First: Power users can do everything with keyboard",
      "Progressive Disclosure: Show simple, reveal complexity on demand"
    ],
    "keyScreens": [
      "Dashboard: Pipeline overview + recent activities + active timer",
      "Contact List: Table with search and filters",
      "Contact Detail: Profile + activity timeline + time tracking",
      "Pipeline Board: Kanban view with drag-and-drop",
      "Deal Detail: Deal info + activity timeline + time tracking",
      "Time Tracking Dashboard (Admin): Hours by user, approval queue, export"
    ],
    "mobileResponsiveness": {
      "breakpoints": {
        "mobile": "<640px",
        "tablet": "640-1024px",
        "desktop": ">1024px"
      },
      "touchTargets": "Minimum 44x44px",
      "navigation": "Hamburger menu on mobile"
    }
  },
  "successMetrics": {
    "development": {
      "month1": "Foundation complete, authentication working",
      "month2": "Core features complete (contacts, deals, activities)",
      "month3": "Polish complete, ready for beta launch"
    },
    "betaLaunch": {
      "userAcquisition": "100 beta users",
      "activation": "80% of users create at least 1 contact and 1 deal",
      "engagement": "60% weekly active users",
      "performance": "P95 page load <2 seconds"
    },
    "postLaunch": {
      "growth": "500 total users",
      "retention": "<10% monthly churn",
      "nps": ">40",
      "revenue": "$5K MRR (assuming $29/user/month, 200 paid users)"
    }
  },
  "implementationRoadmap": {
    "month1": {
      "title": "Foundation",
      "week1": [
        "Project setup (Next.js 15, Supabase, Vercel)",
        "CI/CD pipeline (GitHub Actions)",
        "Database schema v1",
        "Authentication (signup, login, logout)"
      ],
      "week2": [
        "User roles and permissions",
        "Basic UI shell (header, nav, dashboard)",
        "User profile page",
        "Deploy to staging"
      ],
      "weeks3to4": [
        "Contact management (CRUD)",
        "Contact list view with search",
        "Contact detail page"
      ],
      "deliverable": "Working contact management, 5 alpha testers"
    },
    "month2": {
      "title": "Core Features",
      "weeks5to6": [
        "Deal pipeline (Kanban board)",
        "Deal CRUD operations",
        "Deal detail page",
        "Drag-and-drop functionality"
      ],
      "week7": [
        "Activity logging (quick log modal)",
        "Activity timeline component",
        "Keyboard shortcuts",
        "Activity-based time tracking (auto-create time entries)"
      ],
      "week8": [
        "Time tracking: Timer component (start/stop)",
        "Time tracking: Manual entry form",
        "Time tracking: Billable hours configuration",
        "CSV import for contacts"
      ],
      "deliverable": "Full CRM functionality, 20 beta testers"
    },
    "month3": {
      "title": "Polish & Launch",
      "week9": [
        "Time tracking: Approval workflow (submit, approve, reject)",
        "Time tracking: Admin dashboard",
        "Time tracking report + CSV export",
        "Custom fields for contacts"
      ],
      "week10": [
        "Basic reporting (Sales pipeline, Activity summary, Win/loss)",
        "CSV export for contacts/deals",
        "User management (admin features)",
        "Mobile responsive optimization"
      ],
      "week11": [
        "Performance tuning and optimization",
        "Onboarding tutorial",
        "Error handling improvements",
        "Beta testing (50 users)"
      ],
      "week12": [
        "Bug fixes from beta testing",
        "Security audit",
        "Final polish and documentation",
        "Beta Launch: Open to 100 users"
      ]
    }
  },
  "futureRoadmap": {
    "v2": {
      "timeframe": "Months 4-6",
      "theme": "Integrations",
      "features": [
        "Gmail integration (email sync)",
        "Google Calendar integration (meeting sync)",
        "Lead scoring (rule-based)",
        "Email templates",
        "Basic automation (5 workflows)"
      ]
    },
    "v3": {
      "timeframe": "Months 7-12",
      "theme": "Intelligence",
      "features": [
        "AI lead scoring (ML-based)",
        "Slack integration",
        "Stripe integration (billing)",
        "Advanced workflows",
        "Native mobile apps (iOS, Android)"
      ]
    },
    "v4": {
      "timeframe": "Year 2+",
      "theme": "Scale",
      "features": [
        "Zapier integration",
        "Mailchimp integration",
        "Custom reports builder",
        "API for third-party integrations",
        "Marketplace for plugins"
      ]
    }
  },
  "nextSteps": [
    "Architecture review (Architect agent)",
    "Epic/story sharding (PO agent)",
    "Sprint planning (SM agent)",
    "Development start (Dev agent)"
  ]
}
